#! /usr/bin/env python
#import pybel
from pybel import Smarts
###################################################################################

Pattern_HBD = Smarts("[!#6;!H0]")
Pattern_HBA = Smarts("[$([$([#8,#16]);" + "X1,X2]),$([#7X2;#7v3;" + "!$([nH]);!$(*(-a)-a)])]")

###################################################################################

###################################################################################
list_allowed_atoms = [1,6,7,8,9,15,16,17,35,53]
###################= [H,C,N,O,F,P,S,Cl,Br,I]
list_non_allowed_atoms = [2,3,4,5,10,11,12,13,14,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,54,55,56,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,57,58,59,60,61,62,63,64,65,66,67,68,69,70,89,90,91,92,93,94,95,96,97,98,99,100,101,102]
###################################################################################
dico_Warheads = {'Sulfonyl_halide':'[SD4](=O)(=O)[F,Br,I,Cl]',
                 'Acyl_halide':'[F,Cl,Br,I]C(=O)',
                 'Alkyl_halide':'[Cl,Br,I][CH2]',
                 'Anhydride':'O=[CD3]([*])[OD2][CD3](=O)[*]',
                 '1_2_dicarbonyl':'O=[CD3](*)[CD3](=O)[*]',
                 'Perhaloketone':'[F,Br,I,Cl][CX4]([F,Br,I,Cl])([F,Br,I,Cl])[CX3](=O)C',
                 'Aliphatic_ketone':'O=C(C)C([#1])([#1])[#1]',
                 'Epoxide':'[OX2r3]1[#6r3][#6r3]1',
                 'Aziridine':'[#7]1CC1',
                 'Aliphatic_ester':'*C(=O)[OX2]',
                 'Aliphatic_thioester':'CC(=O)S',
                 'Sufonate_ester':'C[SD4](=O)(=O)[OD2]',
                 'Phosphonate_ester':'C[PD4](O)(=O)[OD2]',
                 'Imine':'[NX2;$([N][#6]),$([NH]);!$([N][CX3]=[#7,#8,#15,#16])]=[CX3;$([CH2]),$([CH][#6]),$([C]([#6])[#6])]',
                 'Aldehyde':'[*][CD3]([#1])=[OD1]',
                 'Michael_acceptor':'[OD1]=C(*)C=[CH]([CH3])',
                 'b_heterosubstitued_carbonyl':'C(=O)CC([F,Br,I,Cl])[CH3]',
                 'Oxalyl':'C(=O)C(=O)',
                 'Heteroatom_heteroatom_O_O':'[#6][#8;!R][#8;!R][#6]',
                 'Heteroatom_heteroatom_O_N':'[$([#6][#8;!R][NH1;!R][#6]),$([#6][#8;!R][N;!R]([#6])[#6])]',
                 'Heteroatom_heteroatom_N_N':'[$([#6][NH1;!R]-[NH1;!R][#6]),$([#6][NH1;!R]-[N;!R]([#6])[#6]),$([#6][N;!R]([#6])-[N;!R]([#6])[#6])]',
                 'Heteroatom_heteroatom_N_S':'[$([#6][NH1;!R]-[SD2;!R][#6]),$([#6][N;!R]([#6])-[SD2;!R][#6])]',
                 'Heteroatom_heteroatom_S_O':'[#6][SD2;!R]-[#8;!R][#6]',
                 'Heteroatom_heteroatom_S_S':'[#6][SD2;!R][SD2;!R][#6]',
                 'Halopyrimidine':'c1cnc([F,Cl,Br,I])nc1'                 
                 }
###################################################################################

###################################################################################
dico_Frequent_Hitters = {'Dextrotiroxina-sodica':'[#7H2][CD3]([CD2][cD3]1[cD2][cD3](I)[cD3]([OD2][cD3]2[cD2][cD3](I)[cD3]([OD1])[cD3](I)[cD2]2)[cD3](I)[cD2]1)[CD3](O)=[OD1]',
                         'Methyldopamine':'[CH3][CD4]([#7H2])([CD2][cD3]1[cD2][cD2][cD3]([OD1])[cD3]([OD1])[cD2]1)[CD3]([OD1])=[OD1]',
                         'Diethylstilbestrol':'[CH3][CD2][CD3]([CD3]([CD2][CH3])[cD3]1[cD2][cD2][cD3]([OD1])[cD2][cD2]1)[cD3]2[cD2][cD2][cD3]([OD1])[cD2][cD2]2',        
                         'Tocopherol':'[CH3][CD3]([CH3])[CD2][CD2][CD2][CD3]([CH3])[CD2][CD2][CD2][CD3]([CH3])[CD2][CD2][CD2][CD4]1([CH3])[CD2][CD2][cD3]2[cD3](-[CH3])[cD3]([OD1])[cD3](-[CH3])[cD3](-[CH3])[cD3]2[OD2]1',
                         'Calciferol':'[CH3][CD3]([CH3])[CD2][CD2][CD2][CD3]([CH3])[CD3]1[CD2][CD2][CD3]2[CD4]1([CH3])[CD2][CD2][CD2]\[CD3]2=[CD2]/[CD2]=[CD3]3\[CD2][CD3]([OD1])[CD2][CD2][CD3]3[CH3]',
                         'Benserazide':'[NH2][CD3]([CD2][OD1])[CD3](=O)[ND2][ND2][CD2][cD3]1[cD2][cD2][cD3]([OD1])[cD3]([OD1])[cD3]1[OD1]',
                         'Dextrotiroxina':'[cD2]1[cD3]([cD3]([cD2][cD2][cD3]1[OD2][cD3]1[cD3]([cD2][cD3]([cD2][cD3]1I)[CD2][CD3]([NH2])C(O)=O)I)[OD1])I',
                         'Idebenone':'[CH3][OD2][CD3]1[CD3]([OD2][CH3])[CD3](=O)[CD3]([CD2][CD2][CD2][CD3]([CH3])[CD2][CD2][CD2][CD3]([CH3])[CD2][OD1])[CD3]([CH3])[CD3]1=O',
                         'Dopamine':'[#7][CH2][CH2][cX3]1[cD2][cD2]c([OD1])c([OD1])[cD2]1',
                         'Triazolam':'[cD3]1([CH3])[nD2][nD2][cD3]2[CD2][ND2]=[CD3]([cD3]3[cD2][cD2][cD2][cD2][cD3]3Cl)[cD3]4[cD2][cD3](Cl)[cD2][cD2][cD3]4[nD3]12',
                         'Clofazimine':'[CH3][CD3]([CH3])[ND2][CD3]1[CD2]=[cD3]2[cD3]([CD2]=[CD3]1[ND2][cD3]3[cD2][cD2][cD3](Cl)[cD2][cD2]3)[nD2][cD3]4[cD2][cD2][cD2][cD2][cD3]4[nD3]2[cD3]5[cD2][cD2][cD3]([CH3])[cD2][cD2]5',
                         'Fenoterol':'[CH3][CD3]([CD2][cD3]1[cD2][cD2][cD3]([OD1])[cD2][cD2]1)[ND2][CD2][CD3]([OD1])[cD3]2[cD2][cD3]([OD1])[cD2][cD3]([OD1])[cD2]2',
                         'Apomorphine':'[CH3][ND3]1[CD2][CD2][cD3]2[cD2][cD2][cD2][cD3]-3[cD3]2[CD3]1[CD2][cD3]4[cD2][cD2][cD3]([OD1])[cD3]([OD1])[cD3]-34',
                         'SF85190':'[#6][ND3]([CD2][CD2][CD2]C#C[CD4]([CH3])([CH3])[CH3])[CD2][cD3]1[cD2][cD2][cD2][cD3]2[cD2][cD2][cD2][cD2][cD3]12',
                         'Troglitazone':'[CH3]-[cD3]1[cD3]([CH3])[cD3]([CH3])[cD3]2[OD2][CD4]([CH3])([CD2][OD2][cD3]3[cD2][cD2][cD3]([CD2][CD3]4[SD2][CD3](=O)[ND2][CD3]4=O)[cD2][cD2]3)[CD2][CD2][cD3]2[cD3]1-[CH3]'
                         }
###################################################################################

###################################################################################
dico_Aggregators = {'Indirubin':'O=[CD3]1[ND2][cD3]2[cD2][cD2][cD2][cD2][cD3]2\[CD3]1=[CD3]3\[ND2][cD3]4[cD2][cD2][cD2][cD2][cD3]4[CD3]3=O',
                    '2_17':'[OD1][cD3]1[cD3](N=N[cD3]2[cD2][cD2][cD3](Br)[cD2][cD3]2S([#8-])(=O)=O)[cD3]([cD2][cD3]3[cD2][cD3]([cD3](N=N[cD3]4[cD2][cD2][cD3](Br)[cD2][cD3]4S([#8-])(=O)=O)[cD3](O)[cD3]13)S([#8-])(=O)=O)S([#8-])(=O)=O',
                    '1_13_2':'[#7]-[cD3]1[cD3]([cD2][cD3]([cD3]2[cD2][cD2][cD2][cD2][cD3]12)S([#8-])(=O)=O)N=N[cD3]3[cD2][cD2][cD3]([cD2][cD2]3)-[cD3]4[cD2][cD2][cD3]([cD2][cD2]4)N=N[cD3]5[cD2][cD3]([cD3]6[cD2][cD2][cD2][cD2][cD3]6[cD3]5-[#7])S([#8-])(=O)=O',
                    '1_08':'[#8-][CD3](=O)[cD3]1[cD2][cD2][cD2][cD2][cD3]1\[CD3]([cD3]2[cD2][cD3](I)[cD3](-[#8-])[cD3](I)[cD2]2)=[CD3]3\[CD2]=[CD3](I)[CD3](=O)[CD3](I)=[CD2]3',
                    '1_07':'[OD1][cD3]1[cD2][cD3]([cD3]2[cD2][cD2][cD2][cD2][cD3]2[cD3]1N=N[cD3]3[cD2][cD2][cD3]4[cD2][cD2][cD2][cD2][cD3]4[cD3]3[OD1])S([#8-])(=O)=O',
                    '1_06':'[OD1][cD3]1[cD2][cD2][cD3]2[cD2][cD2][cD2][cD2][cD3]2[cD3]1N=N[cD3]3[cD3](O)[cD2][cD3]([cD3]4[cD2][cD2][cD2][cD2][cD3]34)S([#8-])(=O)=O',
                    '1_04':'[OD1][cD3]1[cD2][cD2][cD2][cD2][cD3]1[CD2]=N[ND2][CD3](=O)[CD3](=O)[ND2]N=[CD2][cD3]2[cD2][cD2][cD2][cD2][cD3]2[OD1]',
                    '2_19':'[#6][CD2][CD2][CD2][CD2][CD2][CD3]([OD2][cD3]1[cD2][cD2][cD3]([cD2][cD2]1)S(=O)(=O)[cD3]2[cD2][cD2][cD3]([OD2][CD2][cD3]3[cD2][cD2][cD2][cD2][cD2]3)[cD2][cD2]2)[CD3]([OD1])=O',
                    '2_18_3':'[OD1][CD3](=O)[CD2][OD2][cD3]1[cD2][cD2][cD3]([cD2][cD2]1)N=N[cD3]2[cD2][cD2][cD3]3[cD2][cD3](Br)[cD2][cD2][cD3]3[cD3]2[OD1]',
                    '2_06':'[CH3][cD3]1[cD2][cD2][cD3]([cD2][cD2]1)[cD3]2[cD2][cD3]([cD2][cD3]([nD2]2)[cD3]3[cD2][cD2][cD3]4[cD2][cD2][cD2][cD2][cD3]4[cD2]3)[CD3]([OD1])=O',
                    '2_05':'[CH3][CD3]([CH3])[CD2][CD3]([OD2][cD3]1[cD2][cD2][cD3]([OD2][CD3](=O)[cD3]2[cD2][cD3]([nD2][cD3]([cD2]2)[cD3]3[cD2][cD2][cD3](Cl)[cD2][cD2]3)[cD3]4[cD2][cD2][cD3](Cl)[cD2][cD2]4)[cD2][cD2]1)[CD3]([OD1])=O',
                    '2_04':'[CH3][CD2][CD2][CD2][cD3]1[cD2][cD2][cD3]([cD2][cD2]1)[cD3]2[cD2][cD3]([cD2][cD3]([nD2]2)[cD3]3[cD2][cD2][cD3](Cl)[cD2][cD2]3)[CD3]([OD1])=O',
                    '2_03':'[OD1][CD3](=O)[cD3]1[cD2][cD3]([nD2][cD3]([cD2]1)[cD3]2[cD2][cD2][cD3]([cD2][cD2]2)[cD3]3[cD2][cD2][cD2][cD2][cD2]3)[cD3]4[cD2][cD2][cD3](Cl)[cD2][cD2]4',
                    '2_02':'[CH3][CD4]([CH3])([CH3])[cD3]1[cD2][cD2][cD3]([cD2][cD2]1)[cD3]2[cD2][cD3]([cD2][cD3]([nD2]2)[cD3]3[cD2][cD2][cD3](Cl)[cD3](Cl)[cD2]3)[CD3]([OD1])=O',
                    '2_01':'[OD1][CD3](=O)[cD3]1[cD2][cD3]([nD2][cD3]([cD2]1)[cD3]2[cD2][cD2][cD3]([SD2][cD3]3[cD2][cD2][cD3](Cl)[cD2][cD2]3)[cD2][cD2]2)[cD3]4[cD2][cD2][cD3](Cl)[cD2][cD2]4',
                    'Sulconazole':'Cl[cD3]1[cD2][cD2][cD3]([CD2][SD2][CD3]([CD2][nD3]2[cD2][cD2][nD2][cD2]2)[cD3]3[cD2][cD2][cD3](Cl)[cD2][cD3]3Cl)[cD2][cD2]1',
                    'Rottlerin':'[CH3][CD3](=O)[cD3]1[cD3]([OD1])[cD3]([CH3])[cD3]([OD1])[cD3]([CD2][cD3]2[cD3]([OD1])[cD3]([CD3](=O)/[CD2]=[CD2]/[cD3]3[cD2][cD2][cD2][cD2][cD2]3)[cD3]4[OD2][CD4]([CH3])([CH3])[CD2]=[CD2][cD3]4[cD3]2[OD1])[cD3]1[OD1]',
                    'Ro318220':'[CH3][nD3]1[cD2][cD3]([CD3]2=[CD3]([CD3](=O)[NH][CD3]2=O)[cD3]3[cD2][nD3]([CD2][CD2][CD2][SD2][CD3]([NH2])=[NH])[cD3]4[cD2][cD2][cD2][cD2][cD3]34)[cD3]5[cD2][cD2][cD2][cD2][cD3]15',
                    'Nicardipine':'[CH3][OD2][CD3](=O)[CD3]1=[CD3]([CH3])[NH][CD3]([CH3])=[CD3]([CD3]1[cD3]2[cD2][cD2][cD2][cD3]([cD2]2)[ND3+]([OD1-])=O)[CD3](=O)[OD2][CD2][CD2][ND3]([CH3])[CD2][cD3]3[cD2][cD2][cD2][cD2][cD2]3',
                    'Miconazole':'Cl[cD3]1[cD2][cD2][cD3]([CD2][OD2][CD3]([CD2][nD3]2[cD2][cD2][nD2][cD2]2)[cD3]3[cD2][cD2][cD3](Cl)[cD2][cD3]3Cl)[cD3](Cl)[cD2]1',
                    'K252c':'O=[CD3]1[NH][CD2][cD3]2[cD3]1[cD3]3[cD3]4[cD2][cD2][cD2][cD2][cD3]4[nH][cD3]3[cD3]5[nH][cD3]6[cD2][cD2][cD2][cD2][cD3]6[cD3]25',
                    'Indigo':'O=[CD3]1[cD3]2[cD2][cD2][cD2][cD2][cD3]2[NH]\[CD3]1=[CD3]3\[NH][cD3]4[cD2][cD2][cD2][cD2][cD3]4[CD3]3=O',
                    'Econazole':'Cl[cD3]1[cD2][cD2][cD3]([CD2][OD2][CD3]([CD2][nD3]2[cD2][cD2][nD2][cD2]2)[cD3]3[cD2][cD2][cD3](Cl)[cD2][cD3]3Cl)[cD2][cD2]1',
                    'Clotrimazole':'Cl[cD3]1[cD2][cD2][cD2][cD2][cD3]1[CD4]([cD3]2[cD2][cD2][cD2][cD2][cD2]2)([cD3]3[cD2][cD2][cD2][cD2][cD2]3)[nD3]4[cD2][cD2][nD2][cD2]4',
                    'Bisindolylmalemide_i':'[CH3][ND3]([CH3])[CD2][CD2][CD2][nD3]1[cD2][cD3]([CD3]2=[CD3]([CD3](=O)[NH][CD3]2=O)[cD3]3[cD2][nD3]([CH3])[cD3]4[cD2][cD2][cD2][cD2][cD3]34)[cD3]5[cD2][cD2][cD2][cD2][cD3]15',
                    'Benzyl_benzoate':'O=[CD3]([OD2][CD2][cD3]1[cD2][cD2][cD2][cD2][cD2]1)[cD3]2[cD2][cD2][cD2][cD2][cD2]2',
                    '2_20':'[CD2]1[CD2][NH][CD2][CD3]([CD2]1)[CD2]=[CD3]2[cD3]3[cD2][cD2][cD2][cD2][cD3]3[cD3]4[cD2][cD2][cD2][cD2][cD3]24',
                    '2_16':'[CH3][cD3]1[cD2][cD3](Cl)[cD2][cD3]2[SD2]\[CD3]([CD3](=O)[cD3]12)=[CD3]3/[SD2][cD3]4[cD2][cD3](Cl)[cD2][cD3]([CH3])[cD3]4[CD3]3=O',
                    '2_15':'[OD1][cD3]1[cD2][cD2][cD3]([ND2]=[ND2][cD3]2[cD2][cD2][cD2][cD3](Br)[cD2]2)[cD2][cD2]1',
                    '2_14':'Cl[cD3]1[cD2][cD2][cD3]2[sD2][cD3]([SD2][cD3]3[nD2][nD2][cD3]([NH][CD3](=O)[cD3]4[cD2][cD2][cD2][sD2]4)[sD2]3)[nD2][cD3]2[cD2]1',
                    '2_13':'[OD1][cD3]1[cD3](/[CD2]=[CD3]2/[CD3](=O)[NH][cD3]3[cD2][cD2][cD2][cD2][cD3]23)[cD2][cD2]c4CCCCc14',
                    '2_11':'[CH3][CD4]([CH3])([CH3])[cD3]1[cD2][cD3](/[CD2]=[CD3]2/[CD3](=O)[NH][cD3]3[nD2][cD2][cD2][cD2][cD3]23)[cD2][cD3]([cD3]1O)[CD4]([CH3])([CH3])[CH3]',
                    '2_10':'O=[CD3]/1[NH][cD3]2[cD2][cD2][cD2][cD2][cD3]2[CD3]1=[CD2][cD3]3[cD2][cD2][cD3]([sD2]3)[cD3]4[cD2][cD2][cD2][sD2]4',
                    '2_08':'[CH3][OD2][cD3]1[cD2][cD2][cD3]2[CD3]3[CD2][CD2][CD4]4([CH3])[CD3]([CD2][CD2][CD3]4[CD3]3[CD2][CD2][cD3]2[cD2]1)[NH][CD2][CD2][CD2][cD3]5[cD2][cD2][cD2][cD2][cD2]5',
                    '2_07':'[CH3][OD2][cD3]1[cD2][cD2][cD3]2[CD3]3[CD2][CD2][CD4]4([CH3])[CD3]([CD2][CD2][CD3]4[CD3]3[CD2][CD2][cD3]2[cD2]1)[NH][CD2][CD2][NH][cD3]5[cD2][cD2][cD3]([cD2][nD2]5)[ND3+](=O)[OD1-]',
                    '1_12':'[OD1][cD3]1[cD2][cD2][cD3]([cD2][cD3]1[OD1])[cD3]2[cD2][sD2][cD3]([NH][cD3]3[cD2][cD2][cD3](F)[cD2][cD3]3F)[nD2]2',
                    '1_11':'[OD1-][ND3+](=O)[cD3]1[cD2][cD2][cD3]([NH][ND3]2[CD3](=O)[CD3]3[CD3]([CD3]2=O)[CD4]4(Cl)[CD3](=[CD3](Cl)[CD4]3(Cl)[CD4]4(Cl)Cl)Cl)[cD3]([cD2]1)[ND3+](=O)[OD1-]',
                    '1_10':'[CH3][CD3]([CH3])[cD3]1[cD2][cD2][cD3](/[CD2]=[CD3]2/[CD3](=O)[NH][cD3]3[cD2][cD2][cD2][cD2][cD3]23)[cD2][cD2]1',
                    '1_09':'[OD1-][cD3]1[cD3](I)[cD2][cD3]2[cD3]([OD2][cD3]3[cD3](I)[cD3]([OD1-])[cD3](I)[cD2][cD3]3[CD4]42[OD2][CD3](=O)[cD3]5[cD3]4[cD3](Cl)[cD3](Cl)[cD3](Cl)[cD3]5Cl)[cD3]1I',
                    '1_05':'[CH3][cD3]1[cD2][cD3](Cl)[cD2][cD3]2[SD2]/[CD3](=[CD3]3/[SD2][cD3]4[cD2][cD3](Cl)[cD2][cD3]([CH3])[cD3]4[CD3]3=O)/[CD3](=O)[cD3]21',
                    '1_03':'[OD1]=[CD3]1[OD2]/[CD3](=[CD2][NH][cD3]2[cD2][cD2][cD3]([OD2][cD3]3[cD2][cD2][cD2][cD2][cD2]3)[cD2][cD2]2)/[cD3]4[cD2][cD2][cD2][cD2][cD3]14',
                    '1_02':'[OD1][cD3]1[cD2][cD2][cD3]([ND2]=[ND2][cD3]2[cD2][cD2][cD3](Br)[cD2][cD2]2)[cD2][cD2]1',
                    '1_01':'[ClD1][cD3]1[cD2][cD2][cD3]2[sD2][cD3]([SD2][cD3]3[nD2][nD2][cD3]([ND2][CD3](=O)[cD3]4[cD2][cD2][cD3]([ClD1])[cD3]([ClD1])[cD2]4)[sD2]3)[nD2][cD3]2[cD2]1',
                    '2_09':'[CH3][OD2][CD3]1[CD2][CD2][CD4]2([CH3])[CD4]([CD2][CD2][CD3]3[CD3]4[CD2][CD2][CD4]([NH][CD2][CD2][NH2])[CD4]4([CH3])[CD2][CD4]([OD1])[CD3]23)[CD2]1',
                    '2_12':'[CH3][ND3]([CH3])[cD3]1[cD2][cD2][cD3](/[CD2]=[CD3]2/[CD3](=O)[NH][cD3]3[cD2][cD2][cD2][cD2][cD3]23)[cD2][cD2]1',
                    'Delavirdine':'[CH3][CD3]([CH3])[NH][cD3]1[cD2][cD2][nD2][cD3]([cD2]1)[ND3]2[CD2][CD2][ND3]([CD2][CD2]2)[CD3](=O)[CD3]3[CD2][cD3]4[cD2][cD3]([NH][SD4](=O)(=O)[CH3])[cD2][cD2][cD3]4[NH]3',
                    'Quercetin':'[OD1][cD3]1[cD2][cD3]([OD1])[cD3]2[cD3](=O)[cD3]([OD1])[cD3]([oD2][cD3]2[cD2]1)[cD3]3[cD2][cD2][cD3]([OD1])[cD3]([OD1])[cD2]3',
                    'U0126':'[NH2]/[CD3](=[CD3](/[CD2]#[ND1])[CD3](=[CD3](/[NH2])[SD2][cD3]1[cD2][cD2][cD2][cD2][cD3]1[NH2])[CD2]#[ND1])/[SD2][cD3]2[cD2][cD2][cD2][cD2][cD3]2[NH2]'
                    }
###################################################################################
dico_Chemicals_Groups = {'Carbazide':'[#7X3][#7X3][#6X3]([#7X3][#7X3])=[OX1]',
                         'Acid_anhydride':'C(=O)OC(=O)',
			 'Pentafluorophenyl_esters':'Fc1c(F)c(C(=O)O)c(F)c(F)c1F',
                         'Paranitrophenyl_esters':'O=COc1ccc(cc1)O[N+](=O)[O-]',
			 'HOBT_esters':'On1nnc2ccccc12',
                         'Triflate':'[#8]S(=O)(=O)C(F)(F)F',
                         'Lawesson_s_reagent':'COc1ccc(cc1)P1(=S)SP(=S)(S1)c1ccc(OC)cc1',
                         'Phosphoramide':'[#7]P([#7])([#7])=O',
			 'Azide':'[NX1]~[NX2]~[NX2,NX1]',
			 'Cytochalasin_derivatives':'C[CH]1CCC[CH](O)C=CC(=O)O[C]23C(=O)N[CH](Cc4ccccc4)[CH]3[CH](C)C(=C)[CH](O)[CH]2C=CC1',
                         'Cycloheximide_derivatives':'[#6]N1C(=O)CCC1=O',
			 'Acylhydrazide':'O=C(NNC(=O)c1ccccc1)Cc1cccc(O)c1',			 
                         'Phosphorane':'*P(*)(*)(*)*',
                         'Chloramidine':'[#6]N([#6])C([#6])=N',
			 'Nitroso':'[NX2](=[OX1])[!#7;!#8]',
			 'P_S_Halide':'[#53,#9,#17,#35][#15,#16]',
                         'Carbodiimide':'[H]N([H])C#N',
			 'Saponin_derivatives':'*CC1(*)C(*)CCC2(*)C1CCC1(*)C2CC=C2C3CC(*)(*)CCC3(*)CCC12*',
                         'Monensin_derivatives':'[#8]C1CC2(CCC(*)(O2)C3CCC(C*)(O3)C4OC(CC4*)C5OC([#8])([#8])C(*)CC5*)OC(C1*)C(*)C(O*)C(*)C([#8])=O', 
			 'Cyanidin_derivatives':'*Oc1cc(O*)c2cc(O*)c([o+]c2c1)c1ccc(O*)c(O*)c1',
			 'Isonitrile':'[CX1-]#[NX2+]',
			 'Triacyloxime':'C(=O)N(C(=O))OC(=O)',			 
                         'Cyanohydrine':'[#8]C(*)(*)C#N',
			 'Acyl_cyanides':'[#6]C(=O)C#N',
			 'Sulfonyl_cyanide':'S(=O)(=O)C#N',			 
			 'Cyanophosphonates':'P(OCC)(OCC)(=O)C#N',
                         'Azocyanamides':'[N;R0]=[N;R0]C#N',
			 'Azoalkanals':'[N;R0]=[N;R0]CC=O',
                         'Polyenes':'*\C(*)=C\C=C\C=C(/*)*',
                         'Squalestatin_derivatives':'CC[CH](C)C[CH](C)/C=C/C(=O)O[CH]1[CH](O)[C]2(CCC(=C)[CH](OC(*)O)[CH](C)Cc3ccccc3)OC32O[CH](C(=O)O)C(O)(C(=O)O)[C]13C(=O)O',
			 'Quinone':'O=C1C=CC(=O)C=C1',			 
			 'Alkyl_phosphate':'[#8]P=O',
			 'Phosphinic_acid':'[PX4;$([H2]),$([H1][#6]),$([H0]([#6])[#6])](=[OX1])[$([OX2H]),$([OX1-])]',
                         'Phosphines_phosphanes':'[H]P([H])[H]',
			 'Imidoyl_halide':'[CX3R0;$([H0][#6]),$([H1])](=[NX2;$([H1]),$([H0][#6;!$(C=[O,N,S])])])[FX1,ClX1,BrX1,IX1]',
			 'Sulfonyl_nitrile':'*S(=O)(=O)C#N',
                         'Phosphonyl_nitrile':'*P(*)(=O)C#N',
			 'Azo':'[$([#6]=[NX2+]=[NX1-]),$([#6-]-[NX2+]#[NX1])]',
			 'Di-peptide':'*-C(=O)-&!@[NH]-C-&!@C(=O)-&!@[NH]-*',
			 'Beta_Halo_Carbonyl':'O=CCC[F,Cl,Br,I]',
			 'Unbranched_chain':'[$([A&D2]),$([A&D1])]!@[A&D2]!@[A&D2]!@[A&D2]!@[A&D2]!@[$([A&D2]),$([A&D1])]',
                         'Nitro':'[#6][$([NX3](~[OD1])~[OD1])]',
                         'Peroxide':'[a,A][OX2][OX2][A,a]',
			 'Phosphonic_acid':'[#6]P([#8])([#8])=O',
                         'Phosphonic_ester':'OC([$([A,a])])P(=O)(O[$([A,a])])O[$([A,a])]',
                         'Phosphoric_acid':'[PX4D4](=[OX1])([$([OX2H]),$([OX1-])])([$([OX2H]),$([OX1-])])[$([OX2H]),$([OX1-])]',
                         'Phosphoric_ester':'COP(=O)(-*)O',
			 'Sulfonic_acid':'[SX4;$([H1]),$([H0][#6])](=[OX1])(=[OX1])[$([OX2H]),$([OX1-])]',
                         'Sulfonic_ester':'[SX4;$([H1]),$([H0][#6])](=[OX1])(=[OX1])[OX2][#6;!$(C=[O,N,S])]',
                         'Terminal_vinyl':'[CH2]=[CH]*',
                         'Hydrazine':'[#6][NX3]([!#8])[NX3;H1]([!#8])',
                         'Propiolactones':'OCCC(=O)',
			 'Iodoxy':'*I(=O)=O',
                         'Iodoso':'*I=O',
                         'N-Oxide':'[$([#7+][OX1-]),$([#7v5]=[OX1]);!$([#7](~[O])~[O]);!$([#7]=[#7])]',
                         'alcohol':'[OX2H][CX4;!$(C([OX2H])[#8,#16,#7,#15])]',
                         'alkene':'[CX3;$([H2]),$([H1][#6]),$(C([#6])[#6])]=[CX3;$([H2]),$([H1][#6]),$(C([#6])[#6])]',
                         'amide':'[NX3][CX3](=[OX1])[#6]',
			 'intra_amino_acid':'[NX3;$([N][CX3](=[OX1])[C][NX3,NX4+])][C][CX3](=[OX1])[NX3;$([N][C][CX3](=[OX1])[NX3,OX2,OX1-])]',
                         'C_terminal_amino_acid':'[NX3;$([N][CX3](=[OX1])[C][NX3,NX4+])][C][CX3](=[OX1])[OX2H,OX1-]',
                         'N-terminal_amino_acid':'[NX3,NX4+;!$([N]~[!#6]);!$([N]*~[#7,#8,#15,#16])][C][CX3](=[OX1])[NX3;$([N][C][CX3](=[OX1])[NX3,OX2,OX1-])]',
                         'amine_all':'[NX3,NX4+;!$([N]~[!#6]);!$([N]*~[#7,#8,#15,#16])]',
			 'carboxylic_acid':'[CX3](=O)[OX2H1]',
			 'iodine':'[#53]',
			 'phenol':'[OX2H]c1ccccc1',
                         'Sulfonamide':'[$([#16X4]([NX3])(=[OX1])(=[OX1])[#6]),$([#16X4+2]([NX3])([OX1-])([OX1-])[#6])]',
                         'Sulfonylurea':'c1ccccc1S(=O)(=O)[NX3;H1]C(=O)[NX3;H1]',
			 'Oxaziridine':'[#6]CCC1N([#6])O1',
                         'Cyclopropyl':'[#6]1[#6][#6]1',
			 'Guanidine':'[N;v3X3,v4X4+][CX3](=[N;v3X2,v4X3+])[N;v3X3,v4X4+]',
			 'Hydroxamic_acid':'[CX3;$([H0][#6]),$([H1])](=[OX1])[#7X3;$([H1]),$([H0][#6;!$(C=[O,N,S])])][$([OX2H]),$([OX1-])]',
                         'Phosphoryl':'[#15]=[#8]',
                         'Alkyne':'[CX2]#[CX2]',
			 'Aniline':'[NX3]c1ccccc1',
			 'Aryl_halide':'[#53,#9,#17,#35][c]',
			 'Carbamate':'[NX3,NX4+][CX3](=[OX1])[OX2,OX1-]',
			 'Ether':'[OD2]([#6])[#6]',
			 'Sulfoxide':'[$([#16X3](=[OX1])([#6])[#6]),$([#16X3+]([OX1-])([#6])[#6])]',
			 'Thiourea':'[NX3:2][CX3:1](=[SX1:3])[NX3:2]',
			 'Thioamide':'[NX3][CX3]=[SX1]',
			 'Thiol':'[#16X2H]',
			 'Urea':'[NX3:2][CX3:1](=[OX1:3])[NX3:2]',
                         'Hydrazone':'[NX3;$([H2]),$([H1][#6]),$([H0]([#6])[#6]);!$(NC=[O,N,S])][NX2]=[#6]',
			 'Hydroxylamine':'[NX3;$([H2]),$([H1][#6]),$([H0]([#6])[#6]);!$(NC=[O,N,S])][OX2;$([H1]),$(O[#6;!$(C=[N,O,S])])]',
			 'Nitrile':'[NX1]#[CX2]',
			 'Sulfide':'[SX2D2]',
			 'Sulfone':'[$([#16X4](=[OX1])(=[OX1])([#6])[#6]),$([#16X4+2]([OX1-])([OX1-])([#6])[#6])]',
                         'Disulfite':'[SX2D2][SX2D2]',
                         'Enamine':'[NX3][CX3]=[CX3]',
                         'Enol_ether':'[OX2]([#6;!$(C=[N,O,S])])[CX3;$([H0][#6]),$([H1])]=[CX3]',
			 'Organometallic':'[!#1;!#5;!#6;!#7;!#8;!#9;!#14;!#15;!#16;!#17;!#33;!#34;!#35;!#52;!#53;!#85]~[#6;!-]',
                         'Dithioacetate':'C([SX2])[SX2]',
                         'Oxime':'[NX2](=[CX3;$([CH2]),$([CH][#6]),$([C]([#6])[#6])])[OX2H]',
                         'Isothiocyanate':'[NX2]=[CX2]=[SX1]',
                         'Isocyanate':'[NX2]=[CX2]=[OX1]',
                         'Lactam':'[#6R][#6X3R](=[OX1])[#7X3;$([H1][#6;!$(C=[O,N,S])]),$([H0]([#6;!$(C=[O,N,S])])[#6;!$(C=[O,N,S])])]',
                         'Lactone':'[#6][#6X3R](=[OX1])[#8X2][#6;!$(C=[O,N,S])]',
                         'Carbonate':'[#8-]C([#8-])=O',
                         'Carbamic_acid':'[NX3,NX4+][CX3](=[OX1])[OX2H,OX1-]',
                         'Thiocarbamate':'*[OX2]C(=S)[NX3H2]',
                         'Triazine123':'n1ccncn1',
                         'Triazine124':'n1ccncn1',
                         'Triazine135':'n1cncnc1',                         
                         'Malonic':'[OX2H1]C(=O)CC(=O)[OX2H1]',
                         'Benzyloxycarbonyl':'C(c1ccccc1)OC(=O)[NX3]',
                         't_butoxycarbonyl':'CC(C)(C)[OX2]C(=O)',
                         'Fluorenylmethoxycarbonyl':'C(=O)OCC1c2ccccc2c2ccccc12',
                         'Tetrahydropyran':'C1CCOCC1',
                         'Methoxyethoxymethyl':'COCCOC',
                         'Benzylether':'c1ccc(cc1)COCc1ccccc1',
                         'Butylether':'CCCCOCCCC',                         
                         'Trimethylsilyl':'C[Si](C)C',
                         't_butyldimethylsilyl':'CC(C)(C)[Si](C)(C)',
                         'triisopropylsilyl':'CC(C)[Si](C(C)C)(C(C)C)',
                         't_butyldiphenylsilyl':'CC(C)(C)[Si](c1ccccc1)c1ccccc1',
                         'Phthalimides':'O=C1NC(=O)c2ccccc12'}
###################################################################################
